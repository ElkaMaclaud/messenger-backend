# Тест кейсы для чатов

## Сценарий 1: Приватный чат между двумя пользователями

### Цель: Проверить создание приватного чата и обмен сообщениями

**Шаги:**
1. **Регистрация пользователей**
   - Создать 3 тестовых пользователя
   - Убедиться, что пользователи созданы успешно

2. **Авторизация**
   - Получить JWT токены для каждого пользователя
   - Сохранить токены для последующих запросов

3. **Создание приватного чата**
   - User1 создает приватный чат с User2
   - Проверить, что чат создан и возвращает ID

4. **Обмен сообщениями**
   - User1 отправляет сообщение в чат
   - User2 отвечает на сообщение
   - User1 отправляет еще одно сообщение

5. **Проверка истории сообщений**
   - User1 запрашивает историю сообщений
   - Убедиться, что все сообщения присутствуют

6. **Получение списка чатов**
   - User1 запрашивает список своих чатов
   - Проверить, что приватный чат в списке

**Ожидаемые результаты:**
- Все запросы возвращают статус 200/201
- Сообщения сохраняются в правильном порядке
- Пользователи видят только свои чаты

## Сценарий 2: Групповой чат

### Цель: Проверить функциональность групповых чатов

**Шаги:**
1. **Создание группового чата**
   - User1 создает групповой чат с User2 и User3
   - Установить название чата
   - Проверить создание чата

2. **Обмен сообщениями в группе**
   - User1 приветствует участников
   - User2 отвечает в чате

3. **Управление участниками**
   - User1 добавляет User3 в чат (если не добавлен при создании)
   - User1 удаляет User3 из чата
   - Проверить ответы сервера

4. **Проверка доступов**
   - User3 пытается написать в чат после удаления
   - Проверить, что доступ запрещен

**Ожидаемые результаты:**
- Групповой чат создается успешно
- Сообщения видны всем участникам
- Управление участниками работает корректно

## Сценарий 3: Проверка безопасности

### Цель: Проверить систему безопасности и права доступа

**Шаги:**
1. **Доступ к чужим чатам**
   - User3 пытается получить доступ к приватному чату User1 и User2
   - Проверить, что доступ запрещен (403/404)

2. **Несуществующие ресурсы**
   - Попытка отправить сообщение в несуществующий чат
   - Проверить обработку ошибок

3. **Невалидные токены**
   - Попытка доступа с невалидным JWT токеном
   - Проверить ответ 401 Unauthorized

**Ожидаемые результаты:**
- Система корректно обрабатывает попытки несанкционированного доступа
- Возвращаются соответствующие HTTP статусы ошибок

## Команды для тестирования

### Автоматические тесты (Jest)
```bash
# Запуск всех e2e тестов
npm run test:e2e

# Запуск только тестов чатов
npx jest test/chats.e2e-spec.ts

# Запуск с детальным выводом
npm run test:e2e -- --verbose